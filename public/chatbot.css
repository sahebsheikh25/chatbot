/* Hacker / Cyberpunk themed chat styles - pure black, neon red/green */
:root{
  --bg:#000000;
  --panel-bg: rgba(8,8,8,0.92);
  --app-height: 100vh; /* updated dynamically on mobile via JS */
  --safe-bottom: env(safe-area-inset-bottom);
  --glass: rgba(255,255,255,0.02);
  --neon-green: #00ff66;
  --neon-glow: rgba(0,255,102,0.14);
  --neon-glow-strong: rgba(0,255,102,0.24);
  --sn-typing-speed: 18; /* ms per character (read by JS) */
  --neon-red: #ff2e2e;
  --muted:#4b4b4b;
}

html,body{ background:var(--bg); }
/* Terminal-like typography */
#sn-chat-root, #sn-chat-panel, #sn-chat-body, #sn-chat-messages, .sn-msg { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, 'Courier New', monospace; color:var(--neon-green); }

/* Subtle scanline / noise overlay */
#sn-chat-panel::before{ content:''; position:absolute; inset:0; pointer-events:none; background-image:linear-gradient(rgba(255,255,255,0.01) 1px, transparent 1px); background-size:100% 4px; opacity:0.04; mix-blend-mode:overlay; }

/* Floating capsule button (draggable) */
#sn-chat-button{
  position:fixed; right:18px; bottom:22px; z-index:99999;
  background: linear-gradient(180deg, rgba(6,12,6,1), rgba(2,6,2,1));
  color: var(--neon-green); border:1px solid rgba(0,255,102,0.12);
  padding:10px 14px; border-radius:999px; cursor:grab; font-weight:700;
  text-shadow: 0 0 6px rgba(0,255,102,0.14);
  box-shadow:
    0 10px 30px rgba(0,0,0,0.6),
    0 0 10px rgba(0,255,102,0.08),
    0 0 30px rgba(0,255,102,0.06);
  transition: transform .18s ease, box-shadow .3s ease;
}
#sn-chat-button:active{ cursor:grabbing; transform:scale(.99); }

/* allow dragging on touch without the browser treating it as pan/zoom */
#sn-chat-button{ touch-action: none; -webkit-user-drag: none; }

/* Neon outer glow + gentle pulse (keeps glow outside button and lightweight) */
#sn-chat-button::after{ content:''; position:fixed; right:18px; bottom:22px; width:56px; height:56px; border-radius:50%; pointer-events:none; background: radial-gradient(circle, rgba(0,255,102,0.16), rgba(0,255,102,0.06) 40%, transparent 60%); z-index:99998; filter:blur(6px); animation:sn-pulse 3.6s ease-in-out infinite; }

@keyframes sn-pulse{ 0%{ transform:scale(1); opacity:0.85 } 50%{ transform:scale(1.16); opacity:0.45 } 100%{ transform:scale(1); opacity:0.85 } }

/* Chat panel */
#sn-chat-panel{
  position:fixed; right:18px; bottom:86px; width:380px; max-width:calc(100% - 32px); height:520px;
  z-index:99999; display:flex; flex-direction:column; border-radius:10px; overflow:hidden;
  background:linear-gradient(180deg, rgba(4,4,4,0.98), rgba(8,8,8,0.94));
  border:1px solid rgba(255,255,255,0.02); box-shadow: 0 20px 50px rgba(0,0,0,0.8);
  transform-origin:bottom right; opacity:0; pointer-events:none; transition:opacity .18s ease, transform .18s ease;
}
#sn-chat-panel::after{
  /* soft neon outer glow */
  content:''; position:absolute; inset:auto -6px -6px -6px; pointer-events:none; z-index: -1;
  width:calc(100% + 36px); height:calc(100% + 36px); left:-18px; top:-18px; border-radius:16px;
  background: radial-gradient(closest-side, var(--neon-glow-strong), transparent 40%);
  filter: blur(18px); opacity:0.95; mix-blend-mode:screen;
}
#sn-chat-panel.open::after{ opacity:1; }
#sn-chat-panel.open{ opacity:1; pointer-events:auto; transform:translateY(0) scale(1); }
#sn-chat-panel.closed{ transform:translateY(12px) scale(.99); }

.sn-chat-header{
  display:flex; align-items:center; justify-content:space-between; padding:10px 12px; gap:8px;
  background:linear-gradient(90deg, rgba(10,10,10,0.9), rgba(6,6,6,0.9));
  border-bottom:1px solid rgba(255,255,255,0.02); color:var(--neon-green);
}

/* Desktop-only draggable cursor on header */
@media (min-width:701px) and (pointer:fine) {
  .sn-chat-header{ cursor:move; -webkit-user-select:none; user-select:none; }
  .sn-chat-header:active{ cursor:grabbing; }
}
.sn-chat-title{ font-size:15px; letter-spacing:1px; }
.sn-chat-title .blink{ display:inline-block; margin-left:6px; color:var(--neon-green); animation:blink 1s steps(2) infinite; }
.sn-chat-status{ color:var(--neon-green); font-weight:700; opacity:0.9; font-size:12px; }
@keyframes blink{ 0%{opacity:1}50%{opacity:0}100%{opacity:1} }
.sn-chat-controls button{ background:transparent; border:none; color:var(--muted); padding:4px 8px; cursor:pointer; font-size:14px }

#sn-chat-body{ flex:1; display:flex; flex-direction:column; padding:12px; gap:6px; overflow:hidden; }
#sn-chat-messages{ flex:1; overflow:auto; display:flex; flex-direction:column; gap:10px; padding-bottom:10px; }
#sn-chat-typing{ margin-left:8px; color:var(--muted); font-weight:700; }
.hidden{ display:none }

/* Message bubbles - terminal style */
.sn-msg{ max-width:78%; padding:10px 12px; border-radius:8px; line-height:1.25; font-size:14px; box-shadow: inset 0 -1px 0 rgba(255,255,255,0.02); border:1px solid rgba(255,255,255,0.02); white-space:pre-wrap; }
.sn-msg.bot{ background:linear-gradient(180deg, rgba(2,6,2,0.7), rgba(2,6,2,0.55)); color:var(--neon-green); align-self:flex-start; border-top-left-radius:3px; text-shadow: 0 0 8px rgba(0,255,76,0.08); }
.sn-msg.bot, .sn-msg.system{ box-shadow: 0 4px 14px rgba(0,0,0,0.6), 0 0 10px rgba(0,255,102,0.06), 0 0 28px rgba(0,255,102,0.04); border:1px solid rgba(0,255,102,0.06); }
.sn-msg.bot .terminal-prefix{ color:var(--neon-green); margin-right:6px; }
.sn-msg.bot .terminal-text{ color:var(--neon-green); }
.sn-msg.user{ background:linear-gradient(180deg, rgba(20,2,2,0.7), rgba(18,2,2,0.55)); color:var(--neon-red); align-self:flex-end; border-top-right-radius:3px; }
.sn-msg.system{ background: transparent; color:#ffb86b; border:0; align-self:center; font-size:12px; padding:6px 8px; border-radius:4px; }
.sn-msg.system .sys-label{ color:#ffb86b; font-weight:700; margin-right:6px; }
.sn-msg.system{ border:1px dashed rgba(255,184,107,0.12); padding:8px 10px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, 'Courier New', monospace }

/* Input bar - fixed at bottom of panel */
#sn-chat-form{ display:flex; gap:8px; padding:10px; border-top:1px solid rgba(255,255,255,0.02); background:transparent; align-items:center; }
#sn-chat-input{ flex:1 1 auto; min-width:0; resize:none; padding:10px 12px; border-radius:8px; border:1px solid rgba(0,255,102,0.08); background: linear-gradient(180deg, rgba(8,10,8,0.9), rgba(6,8,6,0.85)); color: #eaffef; min-height:48px; max-height:160px; caret-color:var(--neon-green); font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, 'Courier New', monospace; box-shadow: inset 0 -1px 0 rgba(255,255,255,0.02); }
#sn-chat-input:focus{ outline:none; border-color: var(--neon-green); box-shadow: 0 0 12px rgba(0,255,102,0.18), 0 0 32px rgba(0,255,102,0.06); }
#sn-chat-input::placeholder{ color: rgba(230,255,230,0.6); }
#sn-chat-send{ background:transparent; color:var(--neon-green); border:1px solid rgba(0,255,102,0.08); padding:8px 12px; border-radius:8px; cursor:pointer; flex:0 0 auto; min-width:48px; height:44px; display:inline-flex; align-items:center; justify-content:center; z-index:30 }

/* input row and prompt */
.sn-input-row{ display:flex; align-items:center; gap:8px; width:100%; }
.sn-input-prompt{ color:var(--neon-green); opacity:0.95; font-weight:700; padding:8px 10px; background:transparent; border-radius:4px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, 'Courier New', monospace }
.sn-input-prompt::after{ content:''; display:inline-block; width:8px }

/* caret styling */
#sn-chat-input{ caret-color:var(--neon-green); }

/* typewriter reveal for bot messages (JS toggles .reveal) */
.sn-msg .terminal-text{ opacity:1; }
.sn-msg.revealing .terminal-text{ opacity:0; }
.sn-msg.revealing .terminal-text.show{ opacity:1; transition:opacity .06s linear; }

/* typing cursor styling inserted by JS */
.typing-cursor{ color:var(--neon-green); margin-left:6px; font-weight:700; text-shadow: 0 0 6px rgba(0,255,102,0.12); animation:blink 1s steps(2) infinite; }
/* neon glow on typed text */
.terminal-text{ text-shadow: 0 0 8px rgba(0,255,102,0.06), 0 0 18px rgba(0,255,102,0.04); }
.sn-msg.revealing .terminal-text{ text-shadow: 0 0 8px var(--neon-glow), 0 0 22px var(--neon-glow-strong); }

/* Mobile fullscreen behaviour */
@media (max-width:700px){
  /* Use dynamic app height to avoid 100vh issues when keyboard opens */
  #sn-chat-panel{ right:0; left:0; top:0; bottom:0; width:100%; height:var(--app-height); border-radius:0; }
  #sn-chat-button{ right:14px; bottom:18px; }
  /* Chat body should resize and the messages area must scroll independently */
  #sn-chat-body{ padding:12px 12px 12px; display:flex; flex-direction:column; }
  /* Make form sticky within the panel so it stays above keyboard without jumping */
  #sn-chat-form{ position:sticky; bottom:var(--safe-bottom, 0); padding:12px; background:linear-gradient(180deg, rgba(6,8,6,0.98), rgba(3,4,3,0.99)); z-index:120; display:block; border-top:1px solid rgba(0,255,102,0.04); }
  .sn-input-row{ align-items:flex-end; }
  /* ensure send button is always visible and doesn't shrink */
  .sn-input-row button{ flex:0 0 auto; min-width:44px; height:44px; display:inline-flex; align-items:center; justify-content:center; }
  /* messages area gets bottom padding to avoid overlap with the sticky form */
  #sn-chat-messages{ padding-bottom: calc( (var(--safe-bottom, 0px) + 92px) ); }
}

/* Focus and accessibility */
#sn-chat-button:focus, #sn-chat-send:focus, #sn-chat-close:focus{ outline:2px solid rgba(0,255,102,0.12); outline-offset:2px }

/* Ensure input and send remain visible above keyboard on mobile */
#sn-chat-form, #sn-chat-input, #sn-chat-send { -webkit-tap-highlight-color: transparent; }
